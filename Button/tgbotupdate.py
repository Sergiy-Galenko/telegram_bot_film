from aiogram.bot import bot
from telegram import InlineKeyboardButton, InlineKeyboardMarkup
from telegram.ext import CommandHandler, CallbackQueryHandler, Updater

HEAD
import random
TOKEN = 'your_token_here'
TOKEN = '5845703570:AAFlOF_HbqpJtWfrplzbpBIh0lpmCyucPHo'
c236db9bac1763efe61babc7c7ba34d9076c56f8

DEFAULT_LANG = 'en'

messages = {
    'en': {'hello': 'Hello!', 'change_lang': 'Change language'},
    'uk': {'hello': '–ü—Ä–∏–≤—ñ—Ç!', 'change_lang': '–ó–º—ñ–Ω–∏—Ç–∏ –º–æ–≤—É'}
}

def get_keyboard():
    keyboard = [
        [InlineKeyboardButton("Change language", callback_data='change_lang')]
    ]
    return InlineKeyboardMarkup(keyboard)

def start(update, context):
    update.message.reply_text(messages[DEFAULT_LANG]["hello"], reply_markup=get_keyboard())

def change_lang(update, context):
    update.callback_query.message.edit_text(text=messages[DEFAULT_LANG]['change_lang'], reply_markup=get_language_keyboard())

def select_language(update, context):
    query = update.callback_query
    lang = query.data
    global DEFAULT_LANG
    DEFAULT_LANG = lang
    query.message.edit_text(text=messages[DEFAULT_LANG]['hello'], reply_markup=get_keyboard())

def get_language_keyboard():
    keyboard = [
        [
            InlineKeyboardButton("üá¨üáß English", callback_data='en'),
            InlineKeyboardButton("üá∫üá¶ –£–∫—Ä–∞—ó–Ω—Å—å–∫–∞", callback_data='uk')
        ]
    ]
    return InlineKeyboardMarkup(keyboard)

def main():
    updater = Updater(TOKEN, use_context=True)
    dispatcher = updater.dispatcher
    dispatcher.add_handler(CommandHandler("start", start))
    dispatcher.add_handler(CallbackQueryHandler(change_lang, pattern='^change_lang$'))
    dispatcher.add_handler(CallbackQueryHandler(select_language, pattern='^(en|uk)$'))
    updater.start_polling()
    updater.idle()

if __name__ == "__main__":
    main()

    def news(update, context):
        news_url = "https://example.com/news"
        message = "–û—Å—Ç–∞–Ω–Ω—ñ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –±–æ—Ç–∞".format(news_url)
        keyboard = [[InlineKeyboardButton("–ß–∏—Ç–∞—Ç–∏", url=news_url)]]
        reply_markup = InlineKeyboardMarkup(keyboard)
        context.bot.send_message(chat_id=update.message.chat_id, text=message, reply_markup=reply_markup)


def find_film(name, year):
    pass


try:

    film = find_film(name='–ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞', year='')
except Exception as e:
    bot.send_message(chat_id='–≤–∞—à_chat_id', text='–ü—Ä–æ–∏–∑–æ—à–ª–∞ –æ—à–∏–±–∫–∞: {}'.format(str(e)))

# —Ñ—É–Ω–∫—Ü–∏—è –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è —é–∑–µ—Ä–∞
def count(update, context):
    # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ –≤—Å–µ—Ö –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤
    subscribers = bot.get_chat_members_count(chat_id=update.effective_chat.id)
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
    with open('subscribers.txt', 'a') as file:
        file.write(f'–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–ø–∏—Å—á–∏–∫–æ–≤: {subscribers}\n')

# —Ñ—É–Ω–∫—Ü–∏—è —Å –Ω–æ–º–µ—Ä–æ–º —Ç–µ–ª–µ—Ñ–æ–Ω–∞
def phone_number(update, context):
    # –ø–æ–ª—É—á–∞—Ç–µ–ª—å –Ω–æ–º–µ—Ä —Ç–µ–ª–µ—Ñ–æ–Ω–∞
    phone_number = update.message.contact.phone_number
    # –ø–æ–ª—É—á–∞—Ç–µ–ª—å –∏–º—è —é–∑–µ—Ä–∞
    username = update.message.contact.first_name
    # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ –≤ —Ç–µ–∫—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª
    with open('subscribers.txt', 'a') as file:
        file.write(f'{username}: {phone_number}\n')


# –æ–±—å–µ–∫—Ç –∞–ø–¥–µ–π—Ç–µ—Ä –∏ —Ñ—É–Ω–∫—Ü–∏–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏
updater = Updater(token=TOKEN, use_context=True)
dispatcher = updater.dispatcher
dispatcher.add_handler(CommandHandler('start', start))
dispatcher.add_handler(MessageHandler(Filters.text(['–ö–æ–ª-–≤–æ —é–∑–µ—Ä—ñ–≤', '–ö–æ–ª–≤–æ —é–∑–µ—Ä—ñ–≤?']), count))
dispatc



























#_________–í—Ç–æ—Ä–æ–π –≤–∞—Ä–∏–∞–Ω—Ç –∫–æ–¥–∞_________
#def start(update, context):
 #   user_id = update.message.from_user.id
  #  language = get_user_language_from_database(user_id)
   # if not language:
     #   update.message.reply_text("–í—ã–±–µ—Ä–∏—Ç–µ —è–∑—ã–∫:", reply_markup=ReplyKeyboardMarkup([["–ê–Ω–≥–ª–∏–π—Å–∫–∏–π", "–£–∫—Ä–∞–∏–Ω—Å–∫–∏–π"]]))
      #  return LANGUAGE
    #else:
      #  send_news(update, context, language)
       # return ConversationHandler.END

#def set_language(update, context):
 #   user_id = update.message.from_user.id
  #  language = update.message.text.lower()
   # save_user_language_to_database(user_id, language)
  #  send_news(update, context, language)
   # return ConversationHandler.END

#def send_news(update, context, language):
 #   if language == "–∞–Ω–≥–ª–∏–π—Å–∫–∏–π":
  #      news_text = "Here are the latest news:"
   #     read_button_text = "Read"
    #    news_url = "—Å—Å—ã–ª–∫–∞"
   # elif language == "—É–∫—Ä–∞–∏–Ω—Å–∫–∏–π":
     #   news_text = "–û—Å—å –æ—Å—Ç–∞–Ω–Ω—ñ –Ω–æ–≤–∏–Ω–∏:"
     #   read_button_text = "–ß–∏—Ç–∞—Ç–∏"
     #   news_url = "—Å—Å—ã–ª–∫–∞"
    #else:
    #   news_text = "Here are the latest news:"
     #   read_button_text = "Read"
      #  news_url = "—Å—Å—ã–ª–∫–∞"
#
 #   keyboard = [[InlineKeyboardButton(read_button_text, url=news_url)]]
  #  reply_markup = InlineKeyboardMarkup(keyboard)
   # update.message.reply_text(news_text, reply_markup=reply_markup)

#conv_handler = ConversationHandler(
 #   entry